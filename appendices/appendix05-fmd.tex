% !TEX root = ../zeth-protocol-specification.tex

\chapter{Fuzzy message detection}\label{appendix:fmd}

As explained in~\ref{zeth-protocol:zeth-receive} and~\ref{client-security:syncing}, in order to receive $\zethnotes$, a $\zeth$ user must listen on a broadcast channel, and try to decrypt all encrypted events emitted by the $\mixer$ contract. While providing the best potential for indistinguishability (all users scan the chain data and expose the same behavior), such routine is particularly expensive to carry out, especially for computationally restricted users (i.e.~users with computationally limited devices).

As a way to trade-off the users' anonymity and the cost of the message detection routine in privacy-preserving protocols, Beck et al.~\cite{DBLP:journals/iacr/BeckLMG21} introduced the notion of \emph{fuzzy message detection schemes}. These protocols allow the delegation of message detection to untrustworthy servers, without revealing precisely which messages belong to the receiver, by allowing receivers to enforce false-positive detection rates.
Such schemes provide a promising avenue for reconciliating recipient anonymity (via \emph{key ambiguity} and message \emph{detection ambiguity}) and the performance of the $\zethnotes$ receiving algorithm that currently needs to run on a machine belonging to (or trusted by) the recipient.

Nevertheless, the selection of the fuzzy detection parameters for $\zeth$ is a challenge, especially the selection of the false-positive rate.
Under the scheme presented in \cite{DBLP:journals/iacr/BeckLMG21}, not only is this parameter public (an additional ``leakage'' of information\footnote{limited to one server (in the best case), or to the whole network (in the worst case --- if the adversary broadcasts all its known information)}, including to potentially adversarial nodes), but this parameter is likely to be set to different values by different users, based on the number of payments they receive through $\zeth$.  This, coupled with the existing gas-related leakages, will increase the set of information leakages in the protocol, the consequences of which are hard to properly estimate. Furthermore, letting such parameters be set by users raises other challenges for wallet developers, user experience (UX) engineers and documentation engineers. In fact, any degree of liberty given to the user increases the potential for ``deviation'' from the ``expected/indistinguishable'' behavior. Hence, UX/documentation/wallet engineers must be able to suggest sensible default values for such parameters, must extensively document the purpose of these parameters and must extensively educate the end-users to maximize the chances of adequate parameter selections. While feasible, such tasks largely rely on modeling efforts\footnote{See e.g.~\url{https://git.openprivacy.ca/openprivacy/fuzzytags-sim}}, which simplify real-world systems and can only be used to simulate a limited set of situations.
Moreover, not being able to easily (i.e.~without distributing new keys) update the false-positive rate over time is problematic in the context of $\zeth$ as it does not allow users to have adaptable false-positive probabilities to account for potential spikes in the number of payments they receive (e.g.~a merchant during sales).

On the other hand, and as mentioned above, being able to use \emph{fuzzy message detection schemes} in $\zeth$ would also widen the user base of the protocol, which, as a consequence, would widen the anonymity set.
